# 2025-08-11

## Context
Temporary cookie files created for FetLife sessions were not cleaned up, risking buildup on disk.

## Decision
Register cleanup of cookie files via `register_shutdown_function` and destructor in `Connection` and add tests to ensure removal.

## Consequences
Ensures no stale session files remain and provides regression coverage.

## Context
Polling previously only updated cursors without relaying content to Discord.

## Decision
Send Discord embeds for new events and writings, using subscription types to select adapter client helpers.

## Consequences
Provides richer notifications to channels but increases message throughput.

## Context
`/fl subscribe` accepted arbitrary types and polling jobs used the raw input.

## Decision
Limit `sub_type` to explicit choices and schedule `poll_adapter` with the stored subscription type.

## Consequences
Prevents invalid subscription types and ensures polling uses canonical values.

## Context
FetLife credentials were globally scoped, preventing per-subscription authentication and risking session crossover.

## Decision
Introduce an `accounts` table with hashed credentials, `/fl account` management commands, and adapter support for an `X-Account-ID` header to isolate sessions per account.

## Consequences
Subscriptions can use different FetLife accounts without sharing cookies, improving privacy and reducing cross-account interference.

## Context
Channels needed visibility into attendee changes for events.

## Decision
Expose `/events/{id}/attendees` in the adapter and add bot support for an `attendees` subscription type that relays RSVP status and comments.

## Consequences
Provides real-time awareness of who is going, maybe going, or not going to events, but increases adapter load when polling attendee lists.

## Context
Group discussions were not tracked, limiting subscription capabilities.

## Decision
Introduce a `group_posts` subscription type with target validation and polling that relays new group posts.

## Consequences
Channels can follow group posts but additional polling may increase adapter workload.
